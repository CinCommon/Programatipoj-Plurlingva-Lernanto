volatile是Java虚拟机提供的轻量级的同步机制

1. 保证内存可见性
2. 不保证原子性
3. 禁止指令重排

JVM(Java虚拟机)

JMM(Java内存模型): JMM本身是一种抽象的概念, 并不真实存在, 它描述的是一组规则和规范, 通过这组规范定义了程序中各个变量(包括实例字段, 静态字段和构成数组对象的元素)的访问方式.

JMM关于同步的规定:

1. 线程解锁前, 必须把共享变量值刷新回**主内存**
2. 线程加锁前, 必须读取主内存的最新值到自己的工作内存
3. 加锁解锁使用同一把锁

主内存:

自己的工作内存: